<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>mkpasswd</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      background: #f4f6f8;
      padding: 40px;
    }
    .app {
      max-width: 520px;
      margin: auto;
      background: white;
      padding: 24px;
      border-radius: 8px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    h1 {
      font-size: 20px;
      margin-bottom: 16px;
    }
    label {
      display: block;
      margin-top: 10px;
    }
    input[type="number"] {
      width: 90px;
    }
    .symbols-group {
      margin-left: 16px;
      margin-top: 8px;
    }
    button {
      margin-top: 20px;
      width: 100%;
      padding: 10px;
      font-size: 16px;
    }
    .result {
      margin-top: 20px;
      padding: 10px;
      background: #eef2f5;
      font-family: monospace;
      white-space: pre-wrap;
      word-break: break-all;
      max-height: 300px;
      overflow-y: auto;
    }
  </style>
</head>
<body>

<div class="app">
  <h1>パスワード生成</h1>

  <label>
    長さ:
    <input type="number" id="length" value="16" min="4" max="64">
  </label>

  <label>
    生成個数:
    <input type="number" id="count" value="10" min="1" max="100">
  </label>

  <label><input type="checkbox" id="lowercase" checked> 英小文字</label>
  <label><input type="checkbox" id="uppercase" checked> 英大文字</label>
  <label><input type="checkbox" id="numbers" checked> 数字</label>

  <label>
    <input type="checkbox" id="useSymbols"> 記号を使う
  </label>

  <div class="symbols-group">
    <label>
      <input type="radio" name="symbolSet" value="_" checked>
      _
    </label>
    <label>
      <input type="radio" name="symbolSet" value="!@#$%&">
      !@#$%&
    </label>
    <label>
      <input type="radio" name="symbolSet" value="!@#$%^&*()-_=+[]{};:,.<>?">
      !@#$%^&*()-_=+[]{};:,.<>?
    </label>
  </div>

  <label>
    記号の数:
    <input type="number" id="symbolCount" value="1" min="0">
  </label>

  <button id="generate">生成する</button>

  <div class="result" id="result"></div>
</div>

<script>
  function randomChar(chars) {
    return chars[Math.floor(Math.random() * chars.length)];
  }

  function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
  }

  function generatePassword(length, symbolCount, symbolSet, charPool) {
    const chars = [];

    for (let i = 0; i < symbolCount; i++) {
      chars.push(randomChar(symbolSet));
    }

    for (let i = symbolCount; i < length; i++) {
      chars.push(randomChar(charPool));
    }

    shuffle(chars);
    return chars.join("");
  }

  document.getElementById("generate").addEventListener("click", () => {
    const length = Number(document.getElementById("length").value);
    const count = Number(document.getElementById("count").value);
    const symbolCount = Number(document.getElementById("symbolCount").value);
    const useSymbols = document.getElementById("useSymbols").checked;

    let charPool = "";
    if (document.getElementById("lowercase").checked) {
      charPool += "abcdefghijklmnopqrstuvwxyz";
    }
    if (document.getElementById("uppercase").checked) {
      charPool += "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
    }
    if (document.getElementById("numbers").checked) {
      charPool += "0123456789";
    }

    if (!charPool) {
      result.textContent = "記号以外の文字種を選択してください";
      return;
    }

    if (useSymbols && symbolCount > length) {
      result.textContent = "記号数が長さを超えています";
      return;
    }

    let symbolSet = "";
    if (useSymbols) {
      symbolSet = document.querySelector(
        'input[name="symbolSet"]:checked'
      ).value;
    }

    const passwords = [];
    for (let i = 0; i < count; i++) {
      passwords.push(
        useSymbols
          ? generatePassword(length, symbolCount, symbolSet, charPool)
          : generatePassword(length, 0, "", charPool)
      );
    }

    result.textContent = passwords.join("\n");
  });
</script>

</body>
</html>
