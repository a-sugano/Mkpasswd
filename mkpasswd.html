<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>mkpasswd</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      background: #f4f6f8;
      padding: 40px;
    }
    .app {
      max-width: 520px;
      margin: auto;
      background: white;
      padding: 24px;
      border-radius: 8px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    h1 {
      font-size: 20px;
      margin-bottom: 16px;
    }
    label {
      display: block;
      margin-top: 10px;
    }
    input[type="number"] {
      width: 90px;
    }
    .symbols-group {
      margin-left: 16px;
      margin-top: 8px;
    }
    button {
      margin-top: 12px;
      width: 100%;
      padding: 10px;
      font-size: 16px;
    }

    /* ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯é¢¨è¡¨ç¤º */
    .code-container {
      position: relative;
      margin-top: 20px;
    }
    .result {
      padding: 12px;
      background: #0f172a;
      color: #e5e7eb;
      font-family: ui-monospace, SFMono-Regular, monospace;
      white-space: pre-wrap;
      word-break: break-all;
      border-radius: 6px;
      max-height: 300px;
      overflow-y: auto;
      font-size: 14px;
    }
    .copy-code {
      position: absolute;
      top: 8px;
      right: 10px;
      font-size: 12px;
      cursor: pointer;
      user-select: none;
      color: #93c5fd;
    }
    .copy-code.copied {
      color: #86efac;
    }
  </style>
</head>
<body>

<div class="app">
  <h1>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆ</h1>

  <label>
    é•·ã•:
    <input type="number" id="length" value="16" min="4" max="64">
  </label>

  <label>
    ç”Ÿæˆå€‹æ•°:
    <input type="number" id="count" value="10" min="1" max="100">
  </label>

  <label><input type="checkbox" id="lowercase" checked> è‹±å°æ–‡å­—</label>
  <label><input type="checkbox" id="uppercase" checked> è‹±å¤§æ–‡å­—</label>
  <label><input type="checkbox" id="numbers" checked> æ•°å­—</label>

  <label>
    <input type="checkbox" id="useSymbols"> è¨˜å·ã‚’ä½¿ã†
  </label>

  <div class="symbols-group">
    <label><input type="radio" name="symbolSet" value="_" checked> _</label>
    <label><input type="radio" name="symbolSet" value="!@#$%&"> !@#$%&</label>
    <label>
      <input type="radio" name="symbolSet"
        value="!@#$%^&*()-_=+[]{};:,.<>?">
      !@#$%^&*()-_=+[]{};:,.<>?
    </label>
  </div>

  <label>
    è¨˜å·ã®æ•°:
    <input type="number" id="symbolCount" value="2" min="0">
  </label>

  <button id="generate">ç”Ÿæˆã™ã‚‹</button>

  <div class="code-container">
    <div class="copy-code" id="copy">ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼</div>
    <div class="result" id="result"></div>
  </div>
</div>

<script>
  const result = document.getElementById("result");
  const copyLabel = document.getElementById("copy");

  function resetCopyState() {
    copyLabel.textContent = "ğŸ“‹ Copy";
    copyLabel.classList.remove("copied");
  }

  function randomChar(chars) {
    return chars[Math.floor(Math.random() * chars.length)];
  }

  function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
  }

  function generatePassword(length, symbolCount, symbolSet, charPool) {
    const chars = [];
    for (let i = 0; i < symbolCount; i++) chars.push(randomChar(symbolSet));
    for (let i = symbolCount; i < length; i++) chars.push(randomChar(charPool));
    shuffle(chars);
    return chars.join("");
  }

  document.getElementById("generate").addEventListener("click", () => {
    resetCopyState();

    const length = +lengthInput.value;
    const count = +countInput.value;
    const symbolCount = +symbolCountInput.value;
    const useSymbols = useSymbolsCheckbox.checked;

    let charPool = "";
    if (lowercase.checked) charPool += "abcdefghijklmnopqrstuvwxyz";
    if (uppercase.checked) charPool += "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
    if (numbers.checked)   charPool += "0123456789";

    if (!charPool) {
      result.textContent = "è¨˜å·ä»¥å¤–ã®æ–‡å­—ç¨®ã‚’é¸æŠã—ã¦ãã ã•ã„";
      return;
    }
    if (useSymbols && symbolCount > length) {
      result.textContent = "è¨˜å·æ•°ãŒé•·ã•ã‚’è¶…ãˆã¦ã„ã¾ã™";
      return;
    }

    const symbolSet = useSymbols
      ? document.querySelector('input[name="symbolSet"]:checked').value
      : "";

    const list = [];
    for (let i = 0; i < count; i++) {
      list.push(
        generatePassword(length, useSymbols ? symbolCount : 0, symbolSet, charPool)
      );
    }
    result.textContent = list.join("\n");
  });

  document.getElementById("copy").addEventListener("click", async () => {
    if (!result.textContent) return;

    await navigator.clipboard.writeText(result.textContent);
    copyLabel.textContent = "âœ… ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ";
    copyLabel.classList.add("copied");
  });

  // shorthand
  const lengthInput = document.getElementById("length");
  const countInput = document.getElementById("count");
  const symbolCountInput = document.getElementById("symbolCount");
  const useSymbolsCheckbox = document.getElementById("useSymbols");
  const lowercase = document.getElementById("lowercase");
  const uppercase = document.getElementById("uppercase");
  const numbers   = document.getElementById("numbers");
</script>

</body>
</html>
